
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RoomSiftay Dashboard</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root {
            --sidebar-blue: #1e293b;
            --bg-light: #f8fafc;
            --text-main: #334155;
            --accent-blue: #3b82f6;
            --success-green: #22c55e;
            --border-color: #f1f5f9;
            
        }

        body { margin: 0; font-family: 'Inter', sans-serif; display: flex; height: 100vh; background: var(--bg-light); color: var(--text-main); }

        /* Sidebar */
        .sidebar { width: 260px; background: var(--sidebar-blue); color: white; display: flex; flex-direction: column; }
        .sidebar-brand { padding: 25px; font-size: 1.5rem; font-weight: bold; display: flex; align-items: center; gap: 10px; }
        .nav-item { padding: 15px 25px; color: #fcfdfeff; text-decoration: none; display: flex; align-items: center; gap: 12px; transition: 0.3s; }
        .nav-item:hover, .nav-item.active { background: #334155; color: white; border-left: 4px solid var(--accent-blue); }

        /* Main Area */
        .main { flex: 1; overflow-y: auto; padding: 30px; }
        .header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 30px; }
        
        /* Stats Grid */
        .stats-grid { display: grid; grid-template-columns: repeat(4, 1fr); gap: 20px; margin-bottom: 30px; }
        .stat-card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); }
        .stat-card h3 { font-size: 0.85rem; color: #64748b; margin: 0; text-transform: uppercase; letter-spacing: 0.5px; }
        .stat-card p { font-size: 1.8rem; font-weight: bold; margin: 10px 0 0; }

        /* Layout Grids */
        .content-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 25px; margin-bottom: 25px; }
        .panel { background: white; border-radius: 12px; padding: 20px; box-shadow: 0 2px 4px rgba(0,0,0,0.05); border: 1px solid #f1f5f9; }
        
        /* Tables */
        table { width: 100%; border-collapse: collapse; margin-top: 15px; }
        th { text-align: left; color: #64748b; font-size: 0.85rem; padding-bottom: 15px; border-bottom: 2px solid var(--border-color); }
        td { padding: 15px 0; border-top: 1px solid var(--border-color); font-size: 0.9rem; }

        /* Chat Panel Styles */
        .chat-container { display: flex; flex-direction: column; height: 100%; max-height: 400px; }
        .chat-list { overflow-y: auto; flex: 1; }
        .chat-item { 
            display: flex; gap: 12px; padding: 12px; border-radius: 8px; 
            transition: 0.2s; cursor: pointer; border-bottom: 1px solid var(--border-color);
        }
        .chat-item:hover { background-color: #f8fafc; }
        .avatar { width: 40px; height: 40px; border-radius: 50%; background: #e2e8f0; flex-shrink: 0; object-fit: cover; }
        .chat-info { flex: 1; min-width: 0; }
        .chat-header { display: flex; justify-content: space-between; align-items: center; }
        .chat-name { font-weight: 600; font-size: 0.9rem; color: #1e293b; }
        .chat-time { font-size: 0.7rem; color: #94a3b8; }
        .chat-msg { font-size: 0.8rem; color: #64748b; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }

        /* Badges & Toggles */
        .badge { padding: 4px 12px; border-radius: 20px; font-size: 0.75rem; font-weight: 600; }
        .badge-active { background: #dcfce7; color: #166534; }
        .badge-pending { background: #fef9c3; color: #854d0e; }
        .switch { position: relative; display: inline-block; width: 40px; height: 20px; }
        .switch input { opacity: 0; width: 0; height: 0; }
        .slider { position: absolute; cursor: pointer; top: 0; left: 0; right: 0; bottom: 0; background: #cbd5e1; border-radius: 20px; transition: .4s; }
        .slider:before { position: absolute; content: ""; height: 14px; width: 14px; left: 3px; bottom: 3px; background: white; border-radius: 50%; transition: .4s; }
        input:checked + .slider { background: var(--success-green); }
        input:checked + .slider:before { transform: translateX(20px); }
    </style>
</head>
<body>

    <aside class="sidebar">
        <div class="sidebar-brand">üè† RoomSiftay</div>
        <a href="#" class="nav-item active"><i class="fas fa-th-large"></i> Dashboard Overview</a>
        <a href="#" class="nav-item"><i class="fas fa-list"></i> My Listings</a>
        <a href="#" class="nav-item"><i class="fas fa-plus-circle"></i> Add New Listings</a>
        <a href="#" class="nav-item"><i class="fas fa-user-check"></i> Owner Identity</a>
        <a href="#" class="nav-item"><i class="fas fa-calendar-check"></i> Availability Status</a>
        <a href="#" class="nav-item"><i class="fas fa-comments"></i> Chats with Buyers</a>
    </aside>

    <main class="main">
        <div class="header">
            <h2>Dashboard Overview</h2>
            <div class="user-profile" style=""flex items-center gap-4">
                <span class="text-gray-300 text-sm">Welcome, {{ owner.ownername }}</span>
                <i class="fas fa-bell" style="color: #131b27ff; cursor: pointer; margin-right: 15px;"></i>
                <span style="font-weight: 600; font-size: 0.9rem; color: var(--text-main);">{{ owner_profile.name }}</span>
                <img src="{{ request.user.profile.image.url }}" alt="Profile" style="width:35px; height:35px; border-radius:50%; margin-left:12px; border: 2px solid white; box-shadow: 0 2px 4px rgba(0,0,0,0.1); object-fit: cover;">
            </div>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <h3>Identity Status</h3>
                <p style="color: {% if owner_profile.is_verified %}var(--success-green){% else %}#f59e0b{% endif %}; font-size: 1rem; display: flex; align-items: center; gap: 5px;">
                    <i class="fas {% if owner_profile.is_verified %}fa-check-circle{% else %}fa-clock{% endif %}"></i> 
                    {% if owner_profile.is_verified %}Verified{% else %}Pending{% endif %}
                </p>
            </div>
            <div class="stat-card">
                <h3>Total Listings</h3>
                <p>{{ total_count }}</p>
            </div>
            <div class="stat-card">
                <h3>Active Listings</h3>
                <p>{{ active_count }}</p>
            </div>
            <div class="stat-card">
                <h3>Pending Chats</h3>
                <p style="color: var(--accent-blue);">{{ messages|length }}</p>
            </div>
        </div>

        <div class="content-grid">
            <div class="panel">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h3 style="margin:0;">My Listings</h3>
                    <button style="border:none; background:none; color:var(--accent-blue); font-size:0.8rem; font-weight:600; cursor:pointer;">View All</button>
                </div>
                <table>
                    <thead>
                        <tr>
                            <th>Property Name</th>
                            <th>Availability</th>
                            <th>Status</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in listings %}
                        <tr>
                            <td>{{ item.title }}</td>
                            <td>
                                <label class="switch">
                                    <input type="checkbox" {% if item.is_available %}checked{% endif %} disabled>
                                    <span class="slider"></span>
                                </label>
                            </td>
                            <td><span class="badge badge-{{ item.status|lower }}">{{ item.status }}</span></td>
                        </tr>
                        {% empty %}
                        <tr><td colspan="3" style="text-align:center; color:#94a3b8; padding: 40px 0;">No listings found.</td></tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>

            <div class="panel">
                <h3 style="margin-top:0;">Verification</h3>
                <div style="display:flex; flex-direction:column; gap:15px; margin-top:20px;">
                    <div style="display:flex; align-items:center; gap:12px; padding:12px; border:1px solid var(--border-color); border-radius:10px;">
                        <i class="fas fa-id-card" style="font-size:1.5rem; color:var(--accent-blue);"></i>
                        <div style="flex:1;">
                            <p style="margin:0; font-size:0.85rem; font-weight:600;">ID Card</p>
                            <p style="margin:0; font-size:0.75rem; color:{% if owner_profile.is_verified %}var(--success-green){% else %}#94a3b8{% endif %};">
                                {% if owner_profile.is_verified %}Verified{% else %}Pending Verification{% endif %}
                            </p>
                        </div>
                        {% if owner_profile.is_verified %}<i class="fas fa-check-circle" style="color:var(--success-green);"></i>{% endif %}
                    </div>

                    <form method="POST" enctype="multipart/form-data" id="authForm">
                        {% csrf_token %}
                        <div style="display:flex; align-items:center; gap:12px; padding:12px; border:1px dashed #cbd5e1; border-radius:10px;">
                            <i class="fas fa-file-alt" style="font-size:1.5rem; color:var(--accent-blue);"></i>
                            <div style="flex:1;">
                                <p style="margin:0; font-size:0.85rem; font-weight:600;">Auth Proof</p>
                                <p style="margin:0; font-size:0.75rem; color:#94a3b8;">
                                    {% if owner_profile.auth_proof %}Document Uploaded{% else %}Not Uploaded{% endif %}
                                </p>
                            </div>
                            <input type="file" name="auth_document" id="file_input" hidden onchange="document.getElementById('authForm').submit();">
                            <button type="button" onclick="document.getElementById('file_input').click();" style="border:none; background:var(--accent-blue); color:white; padding:5px 10px; border-radius:5px; font-size:0.7rem; cursor:pointer;">
                                {% if owner_profile.auth_proof %}Update{% else %}Upload{% endif %}
                            </button>
                        </div>
                    </form>
                </div>
            </div>
        </div>

        <div class="panel" style="margin-top: 25px;">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
                <h3 style="margin:0;">Chats with Buyers</h3>
                <span class="badge" style="background:#eff6ff; color:#1d4ed8;">{{ messages|length }} New Messages</span>
            </div>
            
            <div class="chat-container">
                <div class="chat-list">
                    {% for msg in messages %}
                    <div class="chat-item">
                        <img src="https://ui-avatars.com/api/?name={{ msg.user }}&background=random" class="avatar">
                        <div class="chat-info">
                            <div class="chat-header">
                                <span class="chat-name">{{ msg.user }}</span>
                                <span class="chat-time">{{ msg.time }}</span>
                            </div>
                            <p class="chat-msg">{{ msg.text }}</p>
                        </div>
                        <i class="fas fa-chevron-right" style="color:#e2e8f0; font-size:0.8rem; align-self:center;"></i>
                    </div>
                    {% empty %}
                    <div style="text-align:center; padding: 40px 0; color:#94a3b8;">
                        <i class="fas fa-comments" style="font-size:2rem; display:block; margin-bottom:10px; opacity:0.3;"></i>
                        <p>No active conversations yet.</p>
                    </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    </main>

</body>
</html>