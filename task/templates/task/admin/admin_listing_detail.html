{% extends "task/admin/admin_base.html" %}

{% block title %} Listing{% endblock %}

{% block content %}

<div class="max-w-6xl mx-auto bg-white rounded-[2.5rem] p-10 shadow-sm border border-gray-100">

    <!-- ================= HEADER ================= -->
    <div class="mb-8">
        <h1 class="text-2xl font-semibold text-gray-700">
            {{ listing.title }}
        </h1>
        <p class="text-sm text-gray-400 mt-1">
            Listing Management Panel
        </p>
    </div>

    <!-- ================= DETAILS ================= -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-6 text-gray-600 mb-10">
        <p><span class="font-medium">Room Type:</span> {{ listing.room_type }}</p>
        <p><span class="font-medium">City:</span> {{ listing.city }}</p>
        <p><span class="font-medium">Area:</span> {{ listing.area }}</p>
        <p><span class="font-medium">Monthly Rent:</span> {{ listing.monthly_rent }}</p>
        <p><span class="font-medium">Security Deposit:</span> {{ listing.security_deposit }}</p>
        <p>
            <span class="font-medium">Status:</span>
            <span class="px-3 py-1 rounded-full text-xs font-semibold
                {% if listing.status == 'approved' %}
                    bg-green-100 text-green-600
                {% elif listing.status == 'rejected' %}
                    bg-red-100 text-red-600
                {% else %}
                    bg-yellow-100 text-yellow-600
                {% endif %}
            ">
                {{ listing.get_status_display }}
            </span>
        </p>
    </div>

    <!-- ================= PHOTOS ================= -->
    <div class="mb-10">
        <h3 class="text-lg font-semibold text-gray-700 mb-4">
            Property Photos
        </h3>

        <div class="grid grid-cols-2 md:grid-cols-3 gap-4">
            {% for photo in listing.photos.all %}
                <img src="{{ photo.image.url }}"
                     class="rounded-xl border border-gray-200 object-cover h-48 w-full">
            {% empty %}
                <p class="text-gray-400 italic col-span-full">
                    No photos uploaded.
                </p>
            {% endfor %}
        </div>
    </div>

    <!-- ================= ACTION FORM ================= -->
    <form method="post" class="border-t pt-8">
        {% csrf_token %}

        <label class="block font-medium text-gray-600 mb-2">
            Rejection Reason
        </label>
        <textarea name="admin_note"
                  class="w-full border border-gray-200 rounded-xl p-4 focus:ring-2 focus:ring-blue-200 focus:outline-none"
                  rows="4"
                  placeholder="Required only if rejecting the listing..."></textarea>

        {% if error %}
            <p class="text-red-500 mt-2 text-sm font-medium">
                {{ error }}
            </p>
        {% endif %}

        <div class="flex gap-4 mt-6">
            <button name="action" value="approve"
                    class="bg-green-600 text-white px-6 py-2 rounded-xl text-sm font-semibold shadow hover:bg-green-700 transition">
                ✅ Approve
            </button>

            <button name="action" value="reject"
                    class="bg-red-600 text-white px-6 py-2 rounded-xl text-sm font-semibold shadow hover:bg-red-700 transition">
                ❌ Reject
            </button>
        </div>
    </form>

</div>

{% endblock %}
